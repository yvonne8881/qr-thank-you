<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>è¬è¬å¤§å®¶</title>
  <style>
    body{
      margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center;
      font-family: system-ui, -apple-system, "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", sans-serif;
      background:#fff;
    }
    .card{
      width:min(720px, 92vw);
      border:1px solid rgba(0,0,0,.08);
      border-radius:18px;
      padding:26px 22px;
      text-align:center;
      box-shadow: 0 10px 30px rgba(0,0,0,.06);
    }
    h1{ margin:0; font-size: 28px; font-weight: 800; }
    p{ margin:14px 0 0; font-size: 18px; line-height: 1.75; }
    .hint{ margin-top:12px; font-size: 14px; opacity: .65; line-height: 1.6; }
    .row{ margin-top:16px; text-align:left; }
    label{ display:block; font-size:14px; opacity:.8; margin-bottom:6px; }
    input, textarea{
      width:100%;
      box-sizing:border-box;
      border:1px solid rgba(0,0,0,.14);
      border-radius:12px;
      padding:12px 12px;
      font-size:16px;
      outline:none;
    }
    textarea{ min-height: 120px; resize: vertical; }
    .btns{
      margin-top:18px;
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
    }
    button{
      border: none;
      border-radius: 999px;
      padding: 12px 18px;
      font-size: 16px;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(0,0,0,.08);
      background: rgba(0,0,0,.06);
    }
    button.primary{ background: rgba(0,0,0,.10); }
    button:disabled{ opacity:.5; cursor:not-allowed; }
    .status{ margin-top:12px; font-size: 14px; opacity:.75; }
    .page{ display:none; }
    .page.active{ display:block; }
  </style>
</head>
<body>
  <div class="card">

    <!-- Page 1 -->
    <div class="page active" id="page1">
      <h1>è¬è¬å¤§å®¶çš„å¿ƒæ„ï¼</h1>
      <p>æˆ‘æœ‰ä¸€æ®µè©±æƒ³å°ä½ èªª~</p>
      <div class="hint">æˆ‘å§‹çµ‚ç›¸ä¿¡æ¯ä¸€æ®µç›¸é‡éƒ½æ˜¯ç·£åˆ†ï¼Œå„ä½éƒ½æ˜¯æˆ‘å¾ˆçæƒœçš„äººã€‚</div>
      <div class="btns">
        <button class="primary" id="next1">é»ä¸€ä¸‹</button>
      </div>
    </div>

    <!-- Page 2 -->
    <div class="page" id="page2">
      <h1>å°å°ç©ç¬‘</h1>
      <p>ä½ å€‘çš„ç¥ç¦æˆ‘éƒ½æ”¶åˆ°äº†â€”â€”<br>ğŸ§§ç´…åŒ…æˆ‘ä¹Ÿã€Œç”¨å¿ƒã€æ”¶åˆ°äº†ã€‚</p>
      <div class="hint">çœŸçš„å¾ˆæ„Ÿè¬ä½ å€‘ã€‚</div>
      <div class="btns">
        <button id="back2">ä¸Šä¸€é </button>
        <button class="primary" id="next2">ä¸‹ä¸€é </button>
      </div>
    </div>

    <!-- Page 3 (Form) -->
    <div class="page" id="page3">
      <h1>ç•™ä¸€æ®µè©±çµ¦æˆ‘å§ï½</h1>

      <div class="row">
        <label for="name">æ‚¨çš„åå­—</label>
        <input id="name" type="text" placeholder="è«‹è¼¸å…¥åå­—" maxlength="50" />
      </div>

      <div class="row">
        <label for="msg">æƒ³å·å·å°æˆ‘èªª...</label>
        <textarea id="msg" placeholder="æƒ³èªªçš„è©±æœƒè¢«å¥½å¥½æ”¶è—çš„ï¼" maxlength="500"></textarea>
      </div>

      <div class="btns">
        <button id="back3">ä¸Šä¸€é </button>
        <button class="primary" id="submit">é€å‡º</button>
      </div>

      <div class="status" id="status"></div>
    </div>

    <!-- Page 4 (Thank you) -->
    <div class="page" id="page4">
      <h1>è¬è¬å¤§å®¶ä»Šå¤©çš„åˆ°ä¾†èˆ‡æ”¯æŒâ¤ï¸</h1>
      <p>æ‚¨å¯«ä¸‹çš„è©±ï¼Œæˆ‘å·²ç¶“æ”¶åˆ°äº†ã€‚</p>
      <div class="hint">é¡˜æˆ‘å€‘æœªä¾†éƒ½å¹³å®‰ã€é †å¿ƒã€‚</div>
    </div>

  </div>

<script>
  const GAS_URL = "https://script.google.com/macros/s/AKfycbzTNBK35fT82g30MphU1z3eqgJWs7PnelZoV3SqIEZcz1DzNFUoow2Zlv7i8TSDCPLugg/exec";

  window.addEventListener("DOMContentLoaded", () => {
    const pages = ["page1","page2","page3","page4"].map(id => document.getElementById(id));

    const go = (n) => {
      pages.forEach(p => p.classList.remove("active"));
      document.getElementById("page"+n).classList.add("active");
      window.scrollTo(0,0);
    };

    // ä¸‹ä¸€é  / ä¸Šä¸€é 
    document.getElementById("next1").addEventListener("click", () => go(2));
    document.getElementById("back2").addEventListener("click", () => go(1));
    document.getElementById("next2").addEventListener("click", () => go(3));
    document.getElementById("back3").addEventListener("click", () => go(2));

    // é€å‡º
    const btnSubmit = document.getElementById("submit");
    const statusEl = document.getElementById("status");

   btnSubmit.onclick = () => {
  const name = document.getElementById("name").value.trim();
  const message = document.getElementById("msg").value.trim();

  statusEl.textContent = "";
  if (!name) { statusEl.textContent = "è«‹å…ˆå¡«å¯«åå­—ã€‚"; return; }
  if (!message) { statusEl.textContent = "è«‹å…ˆå¯«ä¸‹æƒ³èªªçš„è©±ã€‚"; return; }
  if (!GAS_URL) { statusEl.textContent = "å°šæœªè¨­å®šè³‡æ–™å„²å­˜ç¶²å€ã€‚"; return; }

  btnSubmit.disabled = true;
  btnSubmit.textContent = "å·²é€å‡º";
  statusEl.textContent = "é€å‡ºä¸­â€¦";

  // ç”¨ GET åƒæ•¸å¯«å…¥ï¼ˆé€éåœ–ç‰‡è«‹æ±‚ï¼Œè¼ƒä¸æœƒè¢«ç€è¦½å™¨æ“‹ï¼‰
  const url =
    GAS_URL +
    "?name=" + encodeURIComponent(name) +
    "&message=" + encodeURIComponent(message) +
    "&ua=" + encodeURIComponent(navigator.userAgent) +
    "&ref=" + encodeURIComponent(document.referrer || "");

  const img = new Image();

  // ä¸ç­‰ onloadï¼šå…ˆå®‰æ’ 0.5 ç§’å¾Œè·³é ï¼Œé¿å… onload ä¸è§¸ç™¼
  const t = setTimeout(() => {
    // å¯é¸ï¼šæ¸…ç©ºè¼¸å…¥
    document.getElementById("name").value = "";
    document.getElementById("msg").value = "";
    go(4);
  }, 500);

  img.onload = () => {
    clearTimeout(t);
    // å¯é¸ï¼šæ¸…ç©ºè¼¸å…¥
    document.getElementById("name").value = "";
    document.getElementById("msg").value = "";
    go(4);
  };

  img.onerror = () => {
    clearTimeout(t);
    statusEl.textContent = "é€å‡ºå¤±æ•—ï¼šè«‹ç¨å¾Œå†è©¦ï¼ˆå¯èƒ½ç¶²è·¯æˆ–æ¬Šé™è¨­å®šï¼‰ã€‚";
    btnSubmit.disabled = false;
    btnSubmit.textContent = "é€å‡º";
  };

  // åŠ ä¸Š cache busterï¼Œé¿å…ç€è¦½å™¨å¿«å–é€ æˆ onload è¡Œç‚ºç•°å¸¸
  img.src = url + "&_ts=" + Date.now();
};

  });
</script>
</body>
</html>
